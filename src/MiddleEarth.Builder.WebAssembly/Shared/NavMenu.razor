@using MiddleEarth.Builder.Infrastructure.Files
@inject ContextImporter Importer
@inject ContextExporter Exporter
@inject IJSRuntime Js

<nav class="navbar fixed-top">
    <div class="container-fluid d-flex justify-content-start">
        <NavLink class="navbar-brand btn btn-link text-inherit mb-2" href="/" Match="NavLinkMatch.All">
            Home
        </NavLink>
        <button class="btn btn-link text-inherit" @onclick="Export"><i class="bi bi-cloud-download"></i> save</button>
        <button class="btn btn-link text-inherit" @onclick="Import"><i class="bi bi-cloud-arrow-up"></i> open</button>
    </div>
</nav>

@code {
    private async Task Import()
    {
        throw new NotImplementedException();
    }

    private async Task Export()
    {
        var fileStream = await Exporter.GetDataStream(CancellationToken.None);
        var fileName = $"Middle-Earth_Builder_{DateTime.Now:yyyy-MM-dd_HH-mm-ss}.zip";

        using var streamRef = new DotNetStreamReference(stream: fileStream);

        await Js.InvokeVoidAsync("downloadFileFromStream", fileName, streamRef);
    }
}